# トラブルシューティング

## Playwright関連のタスクが起動しない、またはエラーになる

### 現象

「認証状態の保存」や「投稿URL取得」など、Playwright（ブラウザ自動操作）を使用するタスクが、強制終了やハングアップの後に実行できなくなることがあります。
ログにロックファイルに関するエラーが出力される場合があります。

### 原因

Playwrightは、ブラウザのプロファイルを複数のプロセスから同時に使用されるのを防ぐために、プロファイルディレクトリ内に `SingletonLock` というロックファイルを作成します。
タスクが異常終了すると、このロックファイルが削除されずに残ってしまい、次にタスクを起動しようとした際に「既に使用中」と判断されてしまうためです。

### 対処法

以下の手順でロックファイルを削除することで、問題を解決できます。

1.  **アプリケーション（Dockerコンテナ）を停止します。**

2.  **ロックファイルを削除します。**

    プロジェクトのルートディレクトリにある `db/playwright_profile/` ディレクトリ内の `SingletonLock` ファイルを削除してください。

    #### Dockerコンテナ内で操作する場合のコマンド例
    コンテナに入り、以下のコマンドを実行します。（`/workspace` の部分は実際のプロジェクトディレクトリのパスに合わせてください）
    ```bash
    rm /workspace/db/playwright_profile/SingletonLock
    ```

3.  **アプリケーション（Dockerコンテナ）を再起動します。**